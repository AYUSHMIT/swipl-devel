################################################################
# Simple relaying Makefile.  For details, please see src/Makefile.in
#
# See also ./configure
################################################################

BUILDARCH=@BUILDARCH@
MTBUILDARCH=@MTBUILDARCH@

all:		@TARGET@

install:	install-@TARGET@

################################################################
# Build just the single-threaded Prolog engine
################################################################

lite::
	@cd $(BUILDARCH) && $(MAKE) all

install-lite::
	@cd $(BUILDARCH) && $(MAKE) install

rpm-install::
	@cd $(BUILDARCH) && $(MAKE) $@

clean::
	@cd $(BUILDARCH) && $(MAKE) $@
	@if [ -f packages/Makefile ]; then \
	   cd packages && make clean; \
	fi
	@if [ -f $(MTBUILDARCH)/Makefile ]; then \
	   cd $(MTBUILDARCH) && make clean; \
	fi

distclean::
	rm -f .pkg-config
	@cd $(BUILDARCH) && $(MAKE) $@
	@if [ -f packages/Makefile ]; then \
	   cd packages && make distclean; \
	fi
	@if [ -f $(MTBUILDARCH)/Makefile ]; then \
	   cd $(MTBUILDARCH) && make distclean; \
	fi

################################################################
# Build the whole default set of tools
################################################################

world:	lite mt .pkg-config packages

.pkg-config:
	cd packages && ./configure --enable-mt
	touch $@

packages::
	cd packages && make

mt::
	cd $(MTBUILDARCH) && make

install-world::
	cd $(BUILDARCH) && make install
	cd $(MTBUILDARCH) && make install-mt
	cd packages && make install
